#并行

---

## 1.进程和线程

我们都知道，程序指令的执行依赖于CPU，假设计算机中只有一个CPU，它是如何运行多个程序的呢？

如果没有计算机上没有安装任何操作系统，那么CPU实际上只能运行一个程序，这个程序独占整个CPU的运行时间。我们现在用的Window，被称之为多任务的操作系统，它内部有一个模块称之为调度器(scheduler)，由它来规划CPU运行每个任务的时间，让CPU时间轮流分配给不同的程序去使用。

宏观上，因为分配切换的速度很快，就造成了并行的假象。

下图表示三个进程轮流使用CPU的情况，`-`表示进程内的一段代码

```
进程1 --        --
进程2   --  --    --  --
进程3     --  --    --
``` 

### 进程
因为物理内存只有一份，每个程序要使用自己独立的内存空间，给程序编写带来复杂性，因此从硬件和操作系统层面都增加了抽象，让应用程序使用虚拟地址，虚拟地址再与物理地址进行映射。

当一个程序运行起来，操作系统为其分配一个独立的虚拟地址空间，这时就启动了一个进程，Window 系统下可以使用`任务管理器`来查看当前运行的所有进程，Linux 系统下可以采用` ps `命令来查看当前运行的所有进程。

### 线程
现代的操作系统，由于安全性方面的考虑，是不允许进程之间直接通信的。那么一个进程内如果想实现并行的效果，轮流使用CPU时间，就需要使用线程。

线程与进程类似，线程内的代码同样可以由调度器分配CPU时间片，达到宏观并行的效果。

## 2.Java中的线程

Java中将线程进行了抽象为`java.lang.Thread`类，而对线程中要运行的任务则抽象为`java.lang.Runnable`接口

### 创建线程
方法1：
```
Thread t = new Thread(new Runnable(){
   public void run() {
      // 要并行执行的代码
   }
});
```
方法2：因为Thread类自己也实现了Runnable接口，因此生成一个Thread的子类，重写run方法也是可以的：

```
Thread t = new Thread(){
   public void run() {
      // 要并行执行的代码
   }
};

```
方法3：如果使用JDK8，可以用lambda表达式简化Runnable的写法：

```
Thread t = new Thread(()-> { // 要并行执行的代码 });
```

### 启动线程



